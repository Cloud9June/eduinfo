<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê¸°ì–µë ¥ ê²Œì„</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            text-align: center;
            background-color: #f0f0f0;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        #timer {
            font-size: 32px;
            font-weight: bold;
            background-color: #000;
            color: #00ff00;
            display: inline-block;
            padding: 10px 20px;
            margin-top: 10px;
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 100px);
            gap: 10px;
            justify-content: center;
            margin-top: 30px;
        }
        /* ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ ì™„ë£Œ í›„ ì—¬ê¸°ë¶€í„° ìŠ¤íƒ€ì¼ */
        .card {
            width: 100px;
            height: 100px;
            position: relative;
            perspective: 1000px; /* 3D íšŒì „ì„ ìœ„í•œ ì›ê·¼ê° */
            cursor: pointer;
        }
        /* ì¹´ë“œ ì•ë’¤ë¥¼ ë’¤ì§‘ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        .card-inner {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            transform: rotateY(0deg); /* ê¸°ë³¸ì€ ì•ë©´ ì•ˆ ë³´ì´ê²Œ */
        }

        /* ì¹´ë“œê°€ ë’¤ì§‘íˆë©´ ì•ë©´ì´ ë³´ì„ */
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }


        .card-front, .card-back {
            width: 100%;
            height: 100%;
            position: absolute;
            backface-visibility: hidden;
            border-radius: 10px;
            font-size: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-front {
            background: #fff;
            border: 2px solid #ccc;
            transform: rotateY(180deg); /* ì•ë©´ì€ íšŒì „ë˜ì–´ ìˆìŒ */
        }

        .card-back {
            background: #4caf50;
            border: 2px solid #388e3c;
            font-size: 24px;
            color: white;
            transform: rotateY(0deg); /* ë’·ë©´ì€ ê¸°ë³¸ ìƒíƒœ */
        }
    </style>
</head>
<body>
    <h1>ğŸ‰ ê¸°ì–µë ¥ ê²Œì„ ğŸ“</h1>
    <div id="timer">00.00ì´ˆ</div>
    <div class="game-board" id="gameBoard"></div>

    <audio src="sounds/pageturn-102978.mp3" id="flipSound" preload="auto"></audio>
    <audio src="sounds/correct-356013.mp3" id="correctSound" preload="auto"></audio>
    <audio src="sounds/error-03-125761.mp3" id="errorSound" preload="auto"></audio>
    <audio src="sounds/you-win-sequence-3-183950.mp3" id="winSound" preload="auto"></audio>

    <script>
        const soundFlip = document.getElementById("flipSound");
        const soundCorrect = document.getElementById("correctSound");
        const soundError = document.getElementById("errorSound");
        const soundWin = document.getElementById("winSound");
        // ìƒìˆ˜ë¡œ ì²˜ë¦¬í•˜ëŠ” ì´ìœ 
        // 1. ì„±ëŠ¥ -> DOM íƒìƒ‰ì€ ë¹„ìš©ì´ í¬ê¸° ë•Œë¬¸ì— ë°˜ë³µ í˜¸ì¶œ ì¤„ì´ê¸°
        // 2. ê°€ë…ì„± -> ì§§ê³  ì½ê¸° ì‰¬ìš´ ì½”ë“œë¡œ ì‘ì„± ê°€ëŠ¥
        // 3. ìœ ì§€ë³´ìˆ˜ -> ìˆ˜ì • ì‹œ í•œ ê³³ë§Œ ê³ ì¹˜ë©´ ë¨
        // 4. ì˜¤ë¥˜ë°©ì§€ -> ì˜¤íƒ€ë‚˜ null ì ‘ê·¼ ë¬¸ì œ ì¤„ì„
        // 5. ì¬ì‚¬ìš©ì„± -> ì—¬ëŸ¬ ê³³ì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

        soundFlip.volume = 1.0;
        soundCorrect.volume = 0.3;
        soundError.volume = 0.3;
        soundWin.volume = 1.0;

        function playSound(audio) {
            audio.currentTime = 0;  // ì˜¤ë””ì˜¤ë¥¼ ë§¨ ì²˜ìŒ(0ì´ˆ ìœ„ì¹˜)ë¶€í„° ì¬ìƒí•˜ë„ë¡ ì„¤ì •
            audio.play();
        }

        const emojis = [
            'ğŸ', 'ğŸŒ', 'ğŸ‡', 'ğŸ“', 'ğŸŠ', 'ğŸ¥',
            'ğŸ', 'ğŸ¥¥', 'ğŸ’', 'ğŸ‰', 'ğŸ', 'ğŸ‘'
        ];

        // ê³¼ì¼ 2ê°œ ìƒì„±í•˜ì—¬ ì„ê¸°
        const shuffled = [...emojis, ...emojis].sort(() => Math.random() - 0.5);
        // ...emojis
        // ... ìŠ¤í”„ë ˆë“œ ë¬¸ë²• -> ìŠ¤í”„ë ˆë“œ ì—°ì‚°ì
        // ë°°ì—´ì˜ ê°’ì„ ë‚˜ì—´í•´ì£¼ëŠ” ê²ƒ!
        // ...emojis, ...emojis ëŠ” ê²°êµ­ ë°°ì—´ì„ 2ë²ˆ ë³µì œí•´ì„œ shuffled ë°°ì—´ì— ë‹´ëŠ” ê²ƒ
        // array.sort(() => Math.random() - 0.5);
        // Math.random()ì€ 0 ì´ìƒ 1 ë¯¸ë§Œì˜ ì‹¤ìˆ˜ (ì˜ˆ: 0.723, 0.102 ë“±)ë¥¼ ë°˜í™˜
        // ì—¬ê¸°ì„œ 0.5ë¥¼ ë¹¼ë©´ -0.5 ~ +0.5 ì‚¬ì´ì˜ ìˆ˜ê°€ ëœë¤ìœ¼ë¡œ ë‚˜ì˜´
        // ì˜ˆ: 0.2 - 0.5 = -0.3 (ìŒìˆ˜)
        // ì˜ˆ: 0.8 - 0.5 = +0.3 (ì–‘ìˆ˜)
        // ì–‘ìˆ˜ì´ë©´ ê·¸ëŒ€ë¡œ, ìŒìˆ˜ê°€ ë‚˜ì˜¤ë©´ ìˆœì„œë¥¼ ë°”ê¿”

        const gameBoard = document.getElementById('gameBoard');
        const timerDisplay = document.getElementById('timer');
        
        let firstCard = null;     // ì²« ë²ˆì§¸ ì„ íƒ ì¹´ë“œ
        let secondCard = null;    // ë‘ ë²ˆì§¸ ì„ íƒ ì¹´ë“œ
        let lockBoard = true;     // í´ë¦­ ì ê¸ˆ ìƒíƒœ
        let matchedCount = 0;     // ë§ì¶˜ ì¹´ë“œ ìˆ˜
        let startTime = 0;        // ì‹œì‘ ì‹œê°„
        let timerInterval = null; // íƒ€ì´ë¨¸ ë°˜ë³µ

        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            startTime = performance.now();
            // performance.now()ëŠ” í˜„ì¬ ì‹œì ì„ "ë°€ë¦¬ì´ˆ(ms)" ë‹¨ìœ„ë¡œ ì•„ì£¼ ì •ë°€í•˜ê²Œ ì¸¡ì •í•´ì£¼ëŠ” ê³ í•´ìƒë„ íƒ€ì´ë¨¸ í•¨ìˆ˜
            timerInterval = setInterval(() => {
                const elapsed = (performance.now() - startTime) / 1000;
                timerDisplay.textContent = `${elapsed.toFixed(2)}ì´ˆ`;
            }, 10);
        }
        // 1. setInterval(() => { ... }, 10);
        // - setInterval**ì€ ì¼ì • ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ì½”ë“œë¥¼ ê³„ì† ë°˜ë³µí•´ì„œ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
        // - 10ì€ ê°„ê²©ì„ 10ë°€ë¦¬ì´ˆ(0.01ì´ˆ)ë¡œ ì„¤ì •
        // 2. performance.now() - startTime
        // - performance.now()ëŠ” í˜„ì¬ ì‹œê°„ (í˜ì´ì§€ ë¡œë“œ í›„ ê¸°ì¤€, ë°€ë¦¬ì´ˆ)
        // - startTimeì€ ê²Œì„ì´ ì‹œì‘ëœ ìˆœê°„ì˜ ì‹œê°„
        // -> ê²Œì„ì´ ì‹œì‘ëœ í›„ ì§€ë‚œ ì‹œê°„(ë°€ë¦¬ì´ˆ)ë¡œ ë‚˜íƒ€ëƒ„
        // 3. / 1000
        // - ë°€ë¦¬ì´ˆ(ms)ë¥¼ ì´ˆ(s)ë¡œ ë°”ê¿ˆ (ì˜ˆ: 1250ms -> 1.25s)
        // 4. elapsed(ì¼ë©ìŠ¤íŠ¸).toFixed(2)
        // - elapsed ëŠ” ì‹¤ìˆ˜, toFixed(2)ëŠ” ì†Œìˆ«ì  2ìë¦¬
        // 5. timerDisplay.textContent = ...
        // - timerDisplayëŠ” <div id="timer"> ìš”ì†Œ
        // - .textContentëŠ” HTML ì•ˆì˜ ê¸€ìë¥¼ ë°”ê¾¸ëŠ” ê¸°ëŠ¥

        // íƒ€ì´ë¨¸ ì •ì§€
        function stopTimer() {
            clearInterval(timerInterval);
        }

        // ì¹´ë“œ HTML ìš”ì†Œ ìƒì„±
        function createCard(emoji, index) { // ì¹´ë“œ ì•ë©´ì˜ ê³¼ì¼ ì´ëª¨ì§€, ì¹´ë“œ ë’·ë©´ì˜ ìˆ«ì
            const card = document.createElement('div');  // ìƒˆë¡œìš´ <div> ìš”ì†Œë¥¼ ìƒì„±í•¨. ë‹¨, ì•„ì§ í™”ë©´ì— ë³´ì´ì§€ ì•Šê³  ë³€ìˆ˜ cardì— ë‹´ê¹€
            card.classList.add('card');  // card ë¼ëŠ” ìš”ì†Œì— "card"ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ì¶”ê°€
            card.dataset.emoji = emoji;  // HTMLìš”ì†Œì— data-emoji="ğŸ" ì†ì„±ì„ ì¶”ê°€í•˜ëŠ” ì½”ë“œ -> ì¹´ë“œ ì§ ë§ëŠ”ì§€ ë¹„êµí•  ë•Œ ì‚¬ìš©
            // dataset ì€ HTML ì˜ data-* ì†ì„±ì„ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë‹¤ë£¨ê¸° ìœ„í•œ ë°©ë²•
            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-front">${emoji}</div>
                    <div class="card-back">${index + 1}</div>
                </div>
            `;
            // card ì•ˆì— ë“¤ì–´ê°ˆ ë‚´ë¶€ HTMLì„ ë¬¸ìì—´ë¡œ í•œ ë²ˆì— ë§Œë“¤ì–´ì„œ ì¶”ê°€
            return card;
            // ì™„ì„±ëœ card DOMìš”ì†Œë¥¼ ê²°ê³¼ë¡œ ë°˜í™˜
            // ì¶”í›„ gameBoard.appendChild(card) ë¡œ ê²Œì„íŒì— ë¶™ì—¬ì¤˜ì•¼ ì‹¤ì œë¡œ ë³´ì´ê²Œ ë¨
        }

        // ì¹´ë“œ ìƒì„± ë° ê²Œì„íŒì— ì¶”ê°€
        shuffled.forEach((emoji, idx) => {
            const card = createCard(emoji, idx);
            gameBoard.appendChild(card);
        });
        // 1. shuffled.forEach((emoji, idx) => { ... });
        // - forEach()ëŠ” ë°°ì—´ì˜ ëª¨ë“  ìš”ì†Œë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì„œ ë°˜ë³µí•˜ëŠ” í•¨ìˆ˜
        // - emojiëŠ” í˜„ì¬ ìš”ì†Œ (ì´ëª¨ì§€ í•˜ë‚˜)
        // - idxëŠ” í˜„ì¬ ì¸ë±ìŠ¤ (0ë¶€í„° ì‹œì‘í•˜ëŠ” ë²ˆí˜¸)
        // 2. const card = createCard(emoji, idx);
        // - ì•ì„œ ë§Œë“  createCard() í•¨ìˆ˜ í˜¸ì¶œ
        // - emojië¥¼ ì¹´ë“œ ì•ë©´ ê·¸ë¦¼ìœ¼ë¡œ ì‚¬ìš©
        // - idxëŠ” ë’·ë©´ ìˆ«ì í‘œì‹œìš© (index + 1)
        // -> í•˜ë‚˜ì˜ ì¹´ë“œ DOM ìš”ì†Œë¥¼ ìƒì„±í•˜ëŠ” ê²ƒ!!
        //3. gameBoard.appendChild(card);
        // - cardë¥¼ ì‹¤ì œ ê²Œì„íŒì— ì¶”ê°€
        // - gameBoardëŠ” HTMLì˜ ì´ ë¶€ë¶„:
        // - <div class="game-board" id="gameBoard"></div>
        // -> gameBoard ì•ˆì— ì¹´ë“œë“¤ì´ í•˜ë‚˜ì”© ë¶™ì–´ì„œ ì „ì²´ ì¹´ë“œíŒì´ ì™„ì„±ë˜ëŠ” êµ¬ì¡°ì•¼.

        const allCards = document.querySelectorAll('.card');
        // querySelectorAll(...) -> íŠ¹ì • ì¡°ê±´ì— ë§ëŠ” ëª¨ë“  ìš”ì†Œë¥¼ ì„ íƒí•˜ëŠ” í•¨ìˆ˜
        // ì¦‰, HTML ë¬¸ì„œì—ì„œ í´ë˜ìŠ¤ ì´ë¦„ "card"ì¸ ëª¨ë“  ìš”ì†Œë¥¼ ì°¾ì•„ì„œ
        // ë°°ì—´ì²˜ëŸ¼ ìƒê¸´ NodeListë¡œ ê°€ì ¸ì˜´
        // NodeList(24) [div.card, div.card, div.card, ..., div.card]
        // ì´ë¥¼ í†µí•´ allCardsë¥¼ ì´ìš©í•˜ì—¬ ëª¨ë“  ì¹´ë“œë¥¼ ëŒ€ìƒìœ¼ë¡œ ê³µí†µì˜ ì‘ì—…ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆìŒ.

        // ì§€ì—° í•¨ìˆ˜ (ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ)
        async function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        // 1. async function delay(ms)
        // - async ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ë¼ëŠ” í‘œì‹œ
        // - ì´ í•¨ìˆ˜ëŠ” í•­ìƒ Promise ê°ì²´ë¥¼ ë°˜í™˜í•¨
        // - msëŠ” ê¸°ë‹¬ë¦´ ì‹œê°„(ë°€ë¦¬ì´ˆ ë‹¨ìœ„)ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ëŠ” ê²ƒ!
        // 2. return new Promise(resolve => setTimeout(resolve, ms))
        // 2-1. setTimeout(resolve, ms)
        //      - setTimeoutì€ msì´ˆ í›„ì— resolve() ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë¼ëŠ” ëœ»ì„.
        //      - ì¦‰, ì¼ì • ì‹œê°„ì´ ì§€ë‚œ í›„ ì•½ì†(Promise)ë¥¼ "í•´ê²°(resolve)" í•˜ê² ë‹¤ëŠ” ì˜ë¯¸.
        // 2-2. new Promise(...)
        //      - promiseëŠ” "ë‚˜ì¤‘ì— ì–´ë–¤ ì‘ì—…ì´ ëë‚  ê²ƒì„ ì•½ì†í•˜ëŠ” ê°ì²´"
        //      - ìš°ë¦¬ê°€ ì§ì ‘ resolve()ë¥¼ í˜¸ì¶œí•´ì•¼ "ëë‚¬ë‹¤"ê³  ì•Œë ¤ì£¼ëŠ” êµ¬ì¡°!!
        // ìì—°ì–´ë¡œ í’€ì–´ë³´ë©´!
        // ë‚˜ëŠ” ms ë°€ë¦¬ì´ˆê°€ ì§€ë‚˜ë©´ ëë‚˜ëŠ” ì•½ì†(Promise)ë¥¼ ë§Œë“¤ê±°ì•¼.
        // ê·¸ ì•½ì†ì€ ì‹œê°„ì´ ë‹¤ ì§€ë‚˜ë©´ resolve()ë¥¼ í˜¸ì¶œí•´ì„œ 'ëë‚¬ì–´!'ë¼ê³  ë§í• ê±°ì•¼!

        // ë‚˜ì˜ ìµœì¢… ì •ë¦¬
        // delay(ms) í•¨ìˆ˜ëŠ”
        // 1. ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì‘ë™í•˜ì—¬,
        // 2. ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆì—ë„ ì›¹ í˜ì´ì§€ëŠ” ë‹¤ë¥¸ ì‘ì—…(í™”ë©´ ê·¸ë¦¬ê¸°, í´ë¦­ ì´ë²¤íŠ¸ ë“±)ì„ ê³„ì† ì§„í–‰í•  ìˆ˜ ìˆê³ ,
        // 3. ì§€ì •ëœ ì‹œê°„ì´ ì§€ë‚˜ë©´ resolve()ê°€ í˜¸ì¶œë˜ì–´ Promiseê°€ ì™„ë£Œë˜ì—ˆë‹¤ëŠ” ì‹ í˜¸ë¥¼ ì£¼ë©°,
        // 4. await delay(ms)ë¥¼ ì‚¬ìš©í•˜ë©´ ê·¸ ì‹œì ê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ë‹¤ìŒ ì½”ë“œë¡œ ë„˜ì–´ê°€ê²Œ ëœë‹¤.

        // ê²Œì„ ì‹œì‘ ì‹œ ëª¨ë“  ì¹´ë“œë¥¼ ìˆœì„œëŒ€ë¡œ ë³´ì—¬ì£¼ê³  ê°ì¶”ëŠ” ì• ë‹ˆë©”ì´ì…˜
        async function sequentialRevealAndHide() {
            for (let i = 0; i < allCards.length; i++) {
                allCards[i].classList.add('flipped');
                playSound(soundFlip);
                await delay(80);
            }

            await delay(1000);

            for (let i = 0; i < allCards.length; i++) {
                allCards[i].classList.remove('flipped');
                playSound(soundFlip);
                await delay(80);
            }

            lockBoard = false;  // í´ë¦­ ì ê¸ˆ í•´ì œ
            startTimer();
        }

        // ê²Œì„ ì‹œì‘ ì‹œ ìë™ ì‹¤í–‰
        sequentialRevealAndHide();
        
        // ì¹´ë“œ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        allCards.forEach(card => {
            card.addEventListener('click', () => {
                if (lockBoard || card.classList.contains('flipped')) return;

                card.classList.add('flipped');
                playSound(soundFlip);

                if (!firstCard) {
                firstCard = card;
                } else {
                secondCard = card;
                lockBoard = true;

                if (firstCard.dataset.emoji === secondCard.dataset.emoji) {
                    // ì •ë‹µ
                    playSound(soundCorrect);
                    matchedCount++;
                    firstCard = null;
                    secondCard = null;
                    lockBoard = false;

                    // ëª¨ë“  ì¹´ë“œ ë§ì¶˜ ê²½ìš°
                    if (matchedCount === emojis.length) {
                    stopTimer();
                    playSound(soundWin);
                    setTimeout(() => alert(`ğŸ‰ ëª¨ë‘ ë§ì·„ìŠµë‹ˆë‹¤! â±ï¸ ${timerDisplay.textContent} ì†Œìš”`), 300);
                    }
                } else {
                    // ì˜¤ë‹µ
                    playSound(soundError);
                    setTimeout(() => {
                    firstCard.classList.remove('flipped');
                    secondCard.classList.remove('flipped');
                    playSound(soundFlip);
                    firstCard = null;
                    secondCard = null;
                    lockBoard = false;
                    }, 1000);
                }
                }
            });
        });
    </script>
</body>
</html>